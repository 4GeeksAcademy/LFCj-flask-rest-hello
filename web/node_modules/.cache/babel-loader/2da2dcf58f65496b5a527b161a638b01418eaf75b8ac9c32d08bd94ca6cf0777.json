{"ast":null,"code":"var _jsxFileName = \"/workspaces/LFCj-flask-rest-hello/web/src/pages/FavsContext.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useState } from \"react\";\nimport { deleteUserFavs, postUserFavs, getUserFavs } from \"../fetches/user\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const FavouritesContext = /*#__PURE__*/createContext({\n  setFavs: () => {},\n  deleteFavs: id => {},\n  addFavs: (id, name, type) => {}\n});\nexport const FavouritesProvider = ({\n  children\n}) => {\n  _s();\n  const [favs, setFavs] = useState([]);\n  const userId = 1;\n  const deleteFavs = (externalId, type) => {\n    const fav = favs.find(fav => fav.external_id === externalId && fav.type === type);\n    if (!fav) {\n      console.error(\"Error: No se encontró el favorito para eliminar\");\n      return;\n    }\n    deleteUserFavs(userId, fav.id).then(() => {\n      refreshFavs();\n    });\n  };\n  const isFav = (id, type) => {\n    return Array.isArray(favs) ? favs.some(fav => fav.id === id && fav.type === type) : false;\n  };\n  const addFavs = (externalId, name, type) => {\n    postUserFavs(userId, externalId, type, name).then(() => {\n      refreshFavs();\n    });\n  };\n  const refreshFavs = () => {\n    getUserFavs(userId).then(data => {\n      console.log(\"Favoritos recibidos:\", data); // 🐛 Debug\n      if (Array.isArray(data)) {\n        setFavs(data);\n      } else {\n        console.error(\"Error: getUserFavs no devolvió un array\", data);\n        setFavs([]); // Evita errores en .some()\n      }\n    }).catch(error => {\n      console.error(\"Error en getUserFavs:\", error);\n      setFavs([]);\n    });\n  };\n  useEffect(() => {\n    refreshFavs();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(FavouritesContext.Provider, {\n    value: {\n      favs,\n      setFavs,\n      addFavs,\n      deleteFavs,\n      isFav\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(FavouritesProvider, \"/0BlQ36dvQ0SHmD11PH7pkr4tYs=\");\n_c = FavouritesProvider;\nvar _c;\n$RefreshReg$(_c, \"FavouritesProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","deleteUserFavs","postUserFavs","getUserFavs","jsxDEV","_jsxDEV","FavouritesContext","setFavs","deleteFavs","id","addFavs","name","type","FavouritesProvider","children","_s","favs","userId","externalId","fav","find","external_id","console","error","then","refreshFavs","isFav","Array","isArray","some","data","log","catch","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/workspaces/LFCj-flask-rest-hello/web/src/pages/FavsContext.jsx"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\nimport { deleteUserFavs, postUserFavs, getUserFavs } from \"../fetches/user\";\n\nexport const FavouritesContext = createContext({\n  setFavs: () => {},\n  deleteFavs: (id) => {},\n  addFavs: (id, name, type) => {},\n});\n\nexport const FavouritesProvider = ({ children }) => {\n  const [favs, setFavs] = useState([]);\n\n  const userId = 1;\n\n  const deleteFavs = (externalId, type) => {\n    const fav = favs.find((fav) => fav.external_id === externalId && fav.type === type);\n    if (!fav) {\n      console.error(\"Error: No se encontró el favorito para eliminar\");\n      return;\n    }\n    deleteUserFavs(userId, fav.id).then(() => {\n      refreshFavs();\n    });\n  };\n\n  const isFav = (id, type) => {\n    return Array.isArray(favs) ? favs.some((fav) => fav.id === id && fav.type === type) : false;\n  };\n  \n\n  const addFavs = (externalId, name, type) => {\n    postUserFavs(userId, externalId, type, name).then(() => {\n      refreshFavs();\n    });\n  };\n\n  const refreshFavs = () => {\n    getUserFavs(userId).then((data) => {\n      console.log(\"Favoritos recibidos:\", data); // 🐛 Debug\n      if (Array.isArray(data)) {\n        setFavs(data);\n      } else {\n        console.error(\"Error: getUserFavs no devolvió un array\", data);\n        setFavs([]); // Evita errores en .some()\n      }\n    }).catch(error => {\n      console.error(\"Error en getUserFavs:\", error);\n      setFavs([]);\n    });\n  };\n  \n\n  useEffect(() => {\n    refreshFavs();\n  }, []);\n\n  return (\n    <FavouritesContext.Provider\n      value={{ favs, setFavs, addFavs, deleteFavs, isFav }}\n    >\n      {children}\n    </FavouritesContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}